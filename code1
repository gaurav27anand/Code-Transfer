def analyze_csv(file_path):
    stage_durations = {}  # To store total time and count of executions per stage
    
    with open(file_path, 'r') as file:
        lines = file.readlines()
        header = lines[0].strip().split(',')
        
        for line in lines[1:]:
            data = line.strip().split(',')
            for i in range(1, len(data), 2):
                stage_name = header[i].replace(' Duration', '')
                stage_duration = data[i]
                
                if stage_duration.isdigit():
                    if stage_name not in stage_durations:
                        stage_durations[stage_name] = {'total_time': 0, 'count': 0}
                    
                    stage_durations[stage_name]['total_time'] += int(stage_duration)
                    stage_durations[stage_name]['count'] += 1
    
    # Calculate the average duration per stage
    for stage_name, stats in stage_durations.items():
        avg_duration = stats['total_time'] / stats['count']
        print(f"Average time for {stage_name}: {avg_duration} ms")

analyze_csv('jenkins_build_data.csv')
